# 需求分析

## 登录

##### 简易流程图							

​						  	注册 & 忘记密码 ——> 显示注册/找回密码窗口

​									|				 |

打开软件 ——> 显示登录窗口 ——> 显示用户面板 ——> 获取用户数据渲染

​									|			 |				   |

​								手动 & 自动 	——>

#### 一、校验

##### 点击登录时校验触发，分为两步：

- 1.检查账号密码是否为空如果是则显示错误提示消息，否则检查账号长度是否达到标准，MG账号为8位，手机号码为11位且最大输入长度为11位。

- 2.上一步通过校验后检查账号长度如果为11位说明输入的是手机号码按照手机号正则校验即可，如果是9位说明是MG账号，需要通过查后端数据库是否存在该账号，同时通过正则校验密码格式是否合法（长度至少为8，至少含有一个字母和一个数字）。

#### 二、登录

登录方式分两种，自动和手动点击登录，自动登录的前提是勾选了记住密码选项，因此需要连带自动选择记住密码。

- 1.自动登录，打开软件时从用户登录历史中获取第一个用户（即上次最后登录的用户），假如该用户数据中自动登录选项为 true 则执行登录函数。

- 2.手动登录，无记住密码选项则手动输密码否则自动填充，点击登录按钮执行登录函数。

#### 三、保存和获取历史用户

用户一旦登录成功代表着这是一个有效用户会，将账号信息缓存到本地中，缓存的内容有：账号、头像、昵称、密码、是否记住密码以及是否自动登录。头像和用户名则会在登录成功时返回，其余通过表单获取。

从本地缓存获取到历史登录用户，方便用户在账号输入栏下拉菜单中能够浏览以及快捷填充账号密码等信息。

## 注册

#### 一、校验 

##### 简易流程图：

##### 昵称 ----> 密码 ----> 确认密码 ---->  手机号码 ---->  验证码 

​																		 		|								|

#####																														          号码是否有效    验证码是否有效

用户注册需要填写的必要项目包括：昵称、密码、确认密码、手机号码和验证码。触发校验时机有两个，一个是在输入框失去焦点时，另一个则在最后一步点击立即注册按钮时触发总校验，同时通过接口查询验证码是否有效。

步骤：

- 1.校验昵称不为空，可以是任何字符。【错误提示：“昵称不能为空”】

- 2.密码校验规则8-16个字符,不包含空格,必须包含数字,字母或字符至少两种。【错误提示：“请填写密码”，“密码不符合规则”】

- 3.确认密码的校验则必须和上一步输入的密码完全一致。【错误提示：“请填写密码”，“两次的输入密码不一致”】

- 4.手机号码需符合现有的所有标准手机号格式。【错误提示：“请填写正确的手机号码”】

- 5.验证码必须为数字且是4位，同时检查验证码是否过期，是否与当前手机号关联。【错误提示：“请填写验证码”，“验证码无效”】

#### 二、成功

注册成功切换到成功结果页，要有一个关闭按钮，同时显示3个必要内容，1.用户昵称 2.派发的MG号码 3.注册的手机号码。

#### 三、失败

注册失败的原因只有一个，用户使用了已经注册过或不存在的手机号码。这里顺便提一下为什么不存在的手机号码可以被发送验证码，原因是我们无法得到该手机号码是否已在运行商中注册过，仅仅能判断的只有手机号码格式是否正确。

##  找回密码

##### 简易流程图：验证手机号码 ----> 重置密码 ----> 改密成功

当用户无法正常登录时或者想重置密码时需要有一个通道进行该操作，而找回密码是必不可少的一项重要功能。本功能设计为通过手机号码+验证码的方式找回。

通常情况下需要3个步骤，大致流程为：

- 1.验证手机号码。在登录框点击找回密码，弹出窗口，如果用户之前已在登录框输入了账号且为手机号码时，自动填充进找回密码的手机号码栏并设置为禁止输入状态，否则需要用户手动输入手机号码。接下来发送验证码到该手机并检查用户输入的验证码是否和手机号关联（前提是验证码在有效期内），没问题则走下一步。

- 2.重置密码。应有两个密码输入框，前者为新密码输入后者为再次确认新密码，之后进入下一步。

- 3.提示用户改密成功，关闭窗口。

## 用户

### 等级特权

##### 一、大贵族：

- 1.知晓对方是否消息已读/未读。

- 2.群聊中单独对某个群员发起私密消息且他人不可见。

- 3.无法被随意踢出群聊，享受3次免踢机会。如果被他人申请强制踢出，且人工审核后因违反互联网法律条款则该特权失效，永久踢出 ，做封号处理。
- 发起弹劾群聊管理员，随参与的大贵族用户或其他用户而增加成功率。
- 享受聊天消息特定的字体颜色。
- .....

##### 二、尊贵会员

### 参考

【Electron 官方文档】<https://www.electronjs.org/zh/docs/latest/>

【Electron + Vite + TS + Vue3 打开新窗口实战】<https://developer.aliyun.com/article/975578#slide-4>

【Electron 无边框窗口】<https://www.jianshu.com/p/adf819473911>

【Electron 实现图片视频本地缓存】 <https://juejin.cn/post/7135640435011092510>

【找回密码功能设计】https://zhuanlan.zhihu.com/p/25171904