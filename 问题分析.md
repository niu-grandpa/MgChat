# 问题分析

## 下面

### 开发遇到的难点

1.如何实现窗口复用，而不是每次关闭后再打开又重新创建窗口。

2.上面实现后会导致大量窗口缓存留在内存中占用资源，如何高效的解决窗口缓存清理

3.如何使得前端全局状态管理工具的数据能够跨窗口共享？

4.如何使用路由渲染新窗口页面且不会导致当前窗口的页面也被改变？

5.如何较好的实现消息本地化缓存与服务器限时存储消息内容

6.渲染进程如何从主线程中获取数据

在 Electron 中，渲染进程和主进程之间的通信可以使用 IPC（Inter-Process Communication）机制。可以使用 IPC 从渲染进程向主进程发送消息，并从主进程向渲染进程发送消息。
要在另一个渲染进程中获取存储在主进程对应的数据，可以使用 IPC 从主进程向该渲染进程发送消息，并将数据作为消息的参数传递。具体的步骤如下： 1.在主进程中，使用 `ipcMain` 模块监听自定义事件，并在事件处理函数中将需要传递的数据作为参数传递给渲染进程:

```js
const { ipcMain } = require('electron');
ipcMain.on('get-data', (event, data) => {
  // 在这里处理获取数据的逻辑，例如从数据库或文件中读取数据
  // 处理完成后，将数据作为参数传递给渲染进程
  event.sender.send('data-ready', data);
});
```

2.在需要获取数据的渲染进程中，使用 `ipcRenderer` 模块向主进程发送消息，并在消息的回调函数中获取数据:

```js
const { ipcRenderer } = require('electron');
ipcRenderer.send('get-data', 'some data');
ipcRenderer.on('data-ready', (event, data) => {
  // 在这里处理获取到的数据
  console.log(data);
});
```

在上面的示例中，我们在主进程中使用 `ipcMain` 监听了名为 `get-data` 的自定义事件，并在事件处理函数中将需要传递的数据作为参数传递给渲染进程。在渲染进程中，我们使用 `ipcRenderer` 向主进程发送了 `get-data` 消息，并将需要传递的数据作为参数传递给了主进程。主进程接收到消息后，处理获取数据的逻辑，并将数据作为参数传递给渲染进程。渲染进程接收到 `data-ready` 消息后，在消息的回调函数中获取到了数据，并进行处理。

7.如何实时收发消息、通知其他好友我已上下线

8.消息存储，从哪里开始存

### Electron+路由

需要转换为多窗口单页应用的思维，而不是一个窗口梭哈所有路由，而随之而来的问题之一，如果使用前端状态管理器工具那么仅仅只能在当前窗口下共享数据，无法实现跨窗口共享，但是可以将数据存储到 Electron 主线程中，这样就实现全局数据共享，或者 localStroage 和 SessionStroage

### 登录注册一体化串联起来的逻辑

### Express 如何接收来自客户端发起的 get 和 post 传递的参数

GET：通过 request.query 获取参数

POST: 通过 request.body 获取参数

### 抽离登陆页面两种登录方式的代码，提取相同点击按钮切换主页的代码

### 在渲染进程中跨窗口传递数据

- 通过 url 传参，不过当数据多的时候此办法不是很好

- 使用 sessionStorage，正好每次登录后返回的用户数据只需要临时存储，而且也可以在不同页面之间传递数据，但是有更好的办法。

- 使用 model 数据流，全局状态管理工具 zustand 库（无法在不同窗口间共享数据），但可以配合 ipcRendered 将数据存储到主线程中

### 实现消息本地化

### 在 Electron 中使用路由渲染每个窗口页面

在 electron 中使用路由渲染新窗口页面是个难点，它的设计是打开一个新窗口需要有对应 html 文件的 url 链接，用于加载页面，而使用路由渲染则没有 html 文件提供给它，始终只有一个 index.html，那么如何解决呢？

.....，

作为渲染新窗口的路由页面需要将其路径配置为第一级，不能作为其他路由的子路由，会造成新窗口同时渲染父路由和子路由。
为什么会造成这个问题？原因是我在父路由页面下放置了 Outlet 组件，这是 react-router-dom 用来渲染子路由节点的，那么当在新窗口中使用这个子路由地址时，实际上是将它对应的父路由页面渲染出来，然后在此页面下再渲染出它的子路由，所以一个窗口要对应一个一级页面。
